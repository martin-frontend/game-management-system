(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9d9dfc1a"],{"2a9a":function(t,e,a){"use strict";a("d568")},"2aa7":function(t,e,a){},"66d9":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"page-container"},[a("search-panel",{ref:"searchPanel",on:{updatedTableData:t.updatedTableData}}),a("div",{staticClass:"table-container"},[a("el-tag",[t._v("活躍帳戶")])],1),a("chart",{staticClass:"account-chart"})],1)},n=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search-panel"},[a("el-tag",[t._v("請輸入查詢條件")]),a("div",{staticStyle:{padding:"5px 0"}}),a("el-form",{ref:"form",attrs:{inline:!0,model:t.searchform,rules:t.rules}},["DAU"===t.date||"NRU"===t.date?[a("el-form-item",{attrs:{prop:"startDate"}},[a("el-date-picker",{attrs:{"value-format":"timestamp",type:"date",placeholder:"選擇開始日期","picker-options":t.startPickerOptions},model:{value:t.searchform.startDate,callback:function(e){t.$set(t.searchform,"startDate",e)},expression:"searchform.startDate"}})],1),a("el-form-item",{attrs:{prop:"endDate"}},[a("el-date-picker",{attrs:{"value-format":"timestamp",type:"date",placeholder:"選擇結束日期","picker-options":t.endPickerOptions},model:{value:t.searchform.endDate,callback:function(e){t.$set(t.searchform,"endDate",e)},expression:"searchform.endDate"}})],1)]:[a("el-form-item",{attrs:{prop:"startDate"}},[a("el-date-picker",{attrs:{"value-format":"timestamp",type:"year",placeholder:"選擇年","picker-options":t.startPickerOptions},model:{value:t.searchform.startDate,callback:function(e){t.$set(t.searchform,"startDate",e)},expression:"searchform.startDate"}})],1)],a("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("查詢")])],2)],1)},i=[],o=a("c1df"),c=a.n(o),l={name:"SearchPanel",data:function(){return{loading:!1,isStartDateError:!1,searchform:{startDate:this.getMonthStart(),endDate:this.getNowMoment(),type:"ALL"},rules:{startDate:[{required:!0,trigger:"change",message:"開始日期不得為空"}],endDate:[{required:!0,trigger:"change",message:"結束日期不得為空"}]},typeOptions:[{value:"all",label:"ALL"},{value:"android",label:"Android"},{value:"ios",label:"iOS"}],date:"DAU",startDate_DAU:this.getMonthStart(),endDate_DAU:this.getNowMoment(),startDate_WAU:this.getYearStart(),startDate_MAU:this.getYearStart(),startDate_NRU:this.getMonthStart(),endDate_NRU:this.getNowMoment()}},computed:{endPickerOptions:function(){var t=this;return{disabledDate:function(e){return!t.isStartDateError&&(c()(e)<c()(t.searchform.startDate)||c()(e)>c()())}}},startPickerOptions:function(){var t=this;return{disabledDate:function(e){return!t.isStartDateError&&c()(e)>c()()}}}},mounted:function(){this.handleSearch()},methods:{saveDate:function(){this["startDate_".concat(this.date)]=this.searchform.startDate,"WAU"!==this.date&&"MAU"!==this.date&&(this["endDate_".concat(this.date)]=this.searchform.endDate)},setDate:function(){this.searchform.startDate=this["startDate_".concat(this.date)],"WAU"!==this.date&&"MAU"!==this.date&&(this.searchform.endDate=this["endDate_".concat(this.date)])},handleSearch:function(){var t=this;this.loading=!0,this.$refs["form"].validate((function(e,a){if(!e)return console.log("error submit!!"),!1;var r=new FormData;r.append("startDate",t.searchform.startDate),"DAU"===t.date||"NRU"===t.date?r.append("endDate",t.searchform.endDate):r.append("endDate",c()(t.searchform.startDate).endOf("year").valueOf()),t.$emit("updatedTableData",r,t.loading)}))},getMonthStart:function(){return c()().startOf("month").valueOf()},getYearStart:function(){return c()().startOf("year").valueOf()},getNowMoment:function(){return c()().format("x")},changeType:function(t){this.saveDate(),this.date=t,this.setDate()}}},d=l,u=a("2877"),h=Object(u["a"])(d,s,i,!1,null,null,null),f=h.exports,p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}},t._l(t.dateOptions,(function(t){return a("el-tab-pane",{key:t.value,attrs:{label:t.label,name:t.value}})})),1),t.$parent.loading?t._e():a("line-marker",{attrs:{type:t.date}}),a("tableData",{attrs:{date:t.date}})],1)},m=[],b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:{height:t.height,width:t.width}})},g=[],D=(a("4160"),a("159b"),a("313e")),v=a.n(D),y=a("ed08"),_={data:function(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted:function(){this.initListener()},activated:function(){this.$_resizeHandler||this.initListener(),this.resize()},beforeDestroy:function(){this.destroyListener()},deactivated:function(){this.destroyListener()},methods:{$_sidebarResizeHandler:function(t){"width"===t.propertyName&&this.$_resizeHandler()},initListener:function(){var t=this;this.$_resizeHandler=Object(y["a"])((function(){t.resize()}),100),window.addEventListener("resize",this.$_resizeHandler),this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},destroyListener:function(){window.removeEventListener("resize",this.$_resizeHandler),this.$_resizeHandler=null,this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)},resize:function(){var t=this.chart;t&&t.resize()}}};a("817d");var k={mixins:[_],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"250px"},autoResize:{type:Boolean,default:!0},type:{type:String,default:""}},inject:["group"],data:function(){return{chart:null,dateList:[],yAxisList:[]}},watch:{"group.tableData":{deep:!0,handler:function(t){t&&this.setOptions(this.group.tableData)}}},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},mounted:function(){var t=this;this.$nextTick((function(){t.initChart()}))},methods:{initChart:function(){this.chart=v.a.init(this.$el,"macarons"),this.setOptions(this.group.tableData)},setOptions:function(t){var e=this;this.dateList=[],this.yAxisList=[];var a=Object(y["b"])(t);a.sort((function(t,e){return t[0]-e[0]})),a.forEach((function(t){e.dateList.push(c()(t[0]).format("YYYY-MM-DD")),e.yAxisList.push(t[1])})),this.chart.setOption({title:{text:a.length?"":"無資料"},xAxis:{data:this.dateList,boundaryGap:!1,axisTick:{show:!1}},grid:{left:40,right:40,bottom:20,top:30,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},yAxis:{axisTick:{show:!1}},legend:{data:["DAU","WAU","MAU"]},series:[{name:"".concat(this.group.date),type:"line",symbolSize:5,symbol:"circle",smooth:0,itemStyle:{normal:{color:"#3888fa",lineStyle:{color:"#3888fa",width:2},areaStyle:{color:"#f3f8ff"}}},data:this.yAxisList,animationDuration:2800,animationEasing:"quadraticOut"}]})}}},O=k,S=Object(u["a"])(O,b,g,!1,null,null,null),A=S.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{attrs:{border:"","header-cell-style":t.headerStyle,data:t.group.tableData}},[a("el-table-column",{attrs:{label:"日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("moment")(e.row[0],"YYYY-MM-DD"))+" ")]}}])}),a("el-table-column",{attrs:{label:t.group.date},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row[1])+" ")]}}])})],1)],1)},U=[],w={name:"TableData",inject:["group"],props:{date:{type:String,default:""}},data:function(){return{headerStyle:{backgroundColor:"#f5f7fa"}}},methods:{handleData:function(){return"dau"===this.date?this.group.tableData.dau:"wau"===this.date?this.group.tableData.wau:this.group.tableData.mau}}},x=w,E=Object(u["a"])(x,$,U,!1,null,null,null),L=E.exports,j={name:"Chart",inject:["group"],components:{LineMarker:A,tableData:L},data:function(){return{date:"DAU",dateOptions:[{value:"DAU",label:"DAU"},{value:"WAU",label:"WAU"},{value:"MAU",label:"MAU"},{value:"NRU",label:"NRU"}]}},methods:{handleClick:function(){this.$parent.changeType(this.date)}}},M=j,z=(a("e7fc"),Object(u["a"])(M,p,m,!1,null,"09ec6d78",null)),N=z.exports,T=a("94b0"),C={name:"Index",components:{searchPanel:f,chart:N},data:function(){return{loading:!1,tableData:[],date:"DAU"}},provide:function(){return{group:this}},methods:{updatedTableData:function(t,e){switch(this.loading=!0,this.date){case"DAU":Object(T["b"])(t).then(this.callbackSuccess).catch(this.callbackError);break;case"WAU":Object(T["f"])(t).then(this.callbackSuccess).catch(this.callbackError);break;case"MAU":Object(T["d"])(t).then(this.callbackSuccess).catch(this.callbackError);break;case"NRU":Object(T["e"])(t).then(this.callbackSuccess).catch(this.callbackError);break}},callbackSuccess:function(t){var e=t.data;e.success?(this.tableData=e.content,this.tableData.sort((function(t,e){return e[0]-t[0]}))):(this.tableData=[],this.$message.warning(e.msg)),this.loading=!1},callbackError:function(t){console.log(t),this.tableData=[],this.loading=!1},changeType:function(t){this.date!==t&&(this.date=t,this.$refs.searchPanel.changeType(t),this.$refs.searchPanel.handleSearch())}}},P=C,R=(a("2a9a"),Object(u["a"])(P,r,n,!1,null,"e3dfd26a",null));e["default"]=R.exports},"94b0":function(t,e,a){"use strict";a.d(e,"g",(function(){return n})),a.d(e,"h",(function(){return s})),a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return c})),a.d(e,"f",(function(){return l})),a.d(e,"d",(function(){return d})),a.d(e,"e",(function(){return u}));var r=a("b775");function n(t){return Object(r["a"])({url:"/analysis_getremain",method:"post",data:t})}function s(t){return Object(r["a"])({url:"/analysis_getrevenue",method:"post",data:t})}function i(t){return Object(r["a"])({url:"/analysis/getuserdau",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/analysis/getuser",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/analysis/getuserlog",method:"post",data:t})}function l(t){return Object(r["a"])({url:"/analysis/getuserwau",method:"post",data:t})}function d(t){return Object(r["a"])({url:"/analysis/getusermau",method:"post",data:t})}function u(t){return Object(r["a"])({url:"/analysis/getusernru",method:"post",data:t})}},d568:function(t,e,a){},e7fc:function(t,e,a){"use strict";a("2aa7")}}]);