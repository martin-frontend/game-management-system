(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59b072ef"],{"003c":function(t,e,a){},1:function(t,e){},"1f6e":function(t,e,a){},2:function(t,e){},3:function(t,e){},5654:function(t,e,a){"use strict";a("76be")},"76be":function(t,e,a){},b8b1:function(t,e,a){"use strict";a("003c")},d8d3:function(t,e,a){"use strict";a("1f6e")},e350:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));a("caad"),a("45fc"),a("ac1f"),a("2532"),a("1276");var n=a("4360");function o(t){if(t&&t instanceof Array&&t.length>0){var e=n["a"].getters&&n["a"].getters.roles,a=e.split(","),o=t,i=a.some((function(t){return o.includes(t)}));return i}return console.error("need roles! Like v-permission=\"['admin','editor']\""),!1}},f580:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-container"},[a("div",{staticClass:"table-container"},[a("el-tag",[t._v("帳號停權")]),t.checkPermission(["修改帳號停權"])?a("el-button",{staticStyle:{float:"right"},attrs:{icon:"el-icon-plus",type:"primary",circle:""},on:{click:t.add}}):t._e(),a("el-tabs",{staticStyle:{"margin-top":"10px"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tabMapOptions,(function(e){return a("el-tab-pane",{key:e.key,attrs:{label:e.label,name:e.key}},["all"===t.activeName?[a("List",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"table-data":t.tableData},on:{initdata:t.initdata}})]:t._e()],2)})),1)],1),a("Dialog",{ref:"dialog",on:{initdata:t.initdata}})],1)},o=[],i=a("2909"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{attrs:{data:t.tableData,border:""}},[t.checkPermission(["修改帳號停權"])?a("el-table-column",{attrs:{prop:"operating",label:"功能",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return t.recovery(e.row)}}},[t._v("復權")])]}}],null,!1,4164920108)}):t._e(),a("el-table-column",{attrs:{prop:"id",label:"編號",width:"180"}}),a("el-table-column",{attrs:{prop:"suspendid",label:"角色ID",width:"180"}}),a("el-table-column",{attrs:{prop:"playerName",label:"角色名稱",width:"180"}}),a("el-table-column",{attrs:{label:"復權時間"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("moment")(e.row.recoverytime))+" ")]}}])}),a("el-table-column",{attrs:{prop:"reason",label:"原因"}})],1),a("div",{staticClass:"table-pagination"},[a("el-pagination",{attrs:{"current-page":1,"page-sizes":[100,200,300,400],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:t.tableData.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},c=[],r=a("e350"),l=a("b775");function u(t){return Object(l["a"])({url:"operation_getsuspension",method:"get",data:t})}function d(t){return Object(l["a"])({url:"operation_createsuspension",method:"post",data:t})}function f(t){return Object(l["a"])({url:"operation_updatesuspension",method:"post",data:t})}var m={name:"Item",props:{tableData:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{checkPermission:r["a"],handleSizeChange:function(t){console.log("每页 ".concat(t," 条"))},handleCurrentChange:function(t){console.log("当前页: ".concat(t))},recovery:function(t){var e=this,a=new FormData;a.append("id",t.id),a.append("recoverytime",""),a.append("suspendstate",0),a.append("reason",""),f(a).then((function(t){var a=t.data;a.success?(e.$emit("initdata"),e.$message.success(a.msg)):e.$message.warning(a.msg)})).catch((function(t){console.log(t)}))}}},p=m,h=(a("b8b1"),a("2877")),b=Object(h["a"])(p,s,c,!1,null,"5a5fa9c6",null),v=b.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:t.title,"before-close":t.handleClose,visible:t.dialogFormVisible,width:"50%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.formData}},[a("el-form-item",{key:t.formData.accounts[0].key,attrs:{label:"帳號ID",prop:"accounts.0.value","label-width":t.formLabelWidth}},[1==t.numberOfAccounts?a("el-input",{staticClass:"form-width form-margin",model:{value:t.formData.accounts[0].id,callback:function(e){t.$set(t.formData.accounts[0],"id",e)},expression:"formData.accounts[0].id"}}):t._e(),t.numberOfAccounts>1?a("el-input",{staticClass:"form-width form-margin",attrs:{disabled:""},model:{value:t.multiAccounts,callback:function(e){t.multiAccounts=e},expression:"multiAccounts"}}):t._e(),a("el-button",{on:{click:t.addAccounts}},[t._v("新增多筆帳號ID")])],1),a("el-form-item",{attrs:{label:"停權天數","label-width":t.formLabelWidth}},[a("el-input",{staticClass:"form-width form-margin",attrs:{disabled:t.formData.checked},model:{value:t.formData.days,callback:function(e){t.$set(t.formData,"days",e)},expression:"formData.days"}})],1),a("el-form-item",{attrs:{label:"結束時間","label-width":t.formLabelWidth}},[a("el-date-picker",{staticClass:"form-margin",attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",disabled:""},model:{value:t.formData.recoverytime,callback:function(e){t.$set(t.formData,"recoverytime",e)},expression:"formData.recoverytime"}}),a("el-checkbox",{model:{value:t.formData.checked,callback:function(e){t.$set(t.formData,"checked",e)},expression:"formData.checked"}},[t._v("永久停權")])],1),a("el-form-item",{attrs:{label:"事由","label-width":t.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",rows:6,placeholder:"請輸入停權事由"},model:{value:t.formData.reason,callback:function(e){t.$set(t.formData,"reason",e)},expression:"formData.reason"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.createSuspension}},[t._v("建 立")])],1)],1),a("AddAccounts",{ref:"addAcounts",attrs:{"form-data":t.formData},on:{setInit:t.setInit}})],1)},D=[],y=(a("c975"),a("a15b"),a("d81d"),a("a434"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:t.title,"before-close":t.handleClose,"close-on-click-modal":!1,visible:t.dialogFormVisible,width:"50%"}},[a("el-form",{attrs:{model:t.formData}},t._l(t.formData.accounts,(function(e,n){return a("el-form-item",{key:e.key,attrs:{label:"帳號ID",prop:"accounts."+n+".value","label-width":t.formLabelWidth}},[a("el-input",{staticClass:"form-width form-margin",model:{value:e.id,callback:function(a){t.$set(e,"id",a)},expression:"account.id"}}),0==n?a("el-button",{on:{click:t.addAccount}},[t._v("新增帳號ID")]):t._e(),0==n?a("el-upload",{staticClass:"upload",attrs:{action:"","on-change":t.handleUpload,"before-upload":t.beforeUpload,"show-file-list":!1,accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","auto-upload":!1}},[a("i",{staticClass:"el-icon-upload2 icon"})]):t._e(),0!=n?a("el-button",{on:{click:function(a){return a.preventDefault(),t.removeAccount(e)}}},[t._v("删除")]):t._e()],1)})),1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addAccounts}},[t._v("新 增")])],1)],1)],1)}),k=[],w=(a("4de4"),a("d3b7"),a("1146")),_=a.n(w),A=a("cd3f"),x={name:"AddAccounts",props:{formData:{type:Object,default:function(){return[]}}},data:function(){return{dialogFormVisible:!1,formLabelWidth:"80px",title:"新增多筆帳號ID",initData:{},excelData:{header:null,results:null}}},methods:{handleClose:function(t){this.loading=!1,this.dialogFormVisible=!1,this.setInit()},handleOpen:function(t,e){this.dialogFormVisible=!0},handleUpload:function(t){var e=this,a=t.raw;return new Promise((function(t,n){var o=new FileReader;o.onload=function(a){var n=a.target.result,o=_.a.read(n,{type:"array"}),i=o.SheetNames[0],s=o.Sheets[i],c=[];for(var r in s)r.indexOf("A")>-1&&("!"===r[0]?c.push({id:s[r]}):c.push({id:s[r].v}));e.generateData({results:c}),t()},o.readAsArrayBuffer(a)}))},generateData:function(t){var e=t.results;this.formData.accounts=e},beforeUpload:function(t,e){console.log(t,e);var a=".csv"===t.type,n="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t.type,o="application/vnd.ms-excel"===t.type;return a||n||o?a||n||o:(this.$message.error("格式錯誤"),!1)},removeAccount:function(t){var e=this.formData.accounts.indexOf(t);-1!==e&&this.formData.accounts.splice(e,1)},addAccount:function(){this.formData.accounts.push({id:"",key:Date.now()})},addAccounts:function(){this.formData.accounts=this.formData.accounts.filter((function(t,e,a){return""!==t.id})),0===this.formData.accounts.length&&(this.formData.accounts=[{id:""}]),this.dialogFormVisible=!1},createInit:function(){var t=A(this.formData);this.initData=t},setInit:function(){var t=A(this.initData);this.$emit("setInit",t)}}},C=x,O=(a("d8d3"),Object(h["a"])(C,y,k,!1,null,"9a2db998",null)),$=O.exports,I=a("c1df"),F=a.n(I),j={components:{AddAccounts:$},data:function(){return{formData:{accounts:[{id:""}],recoverytime:"",checked:!1,reason:""},dialogFormVisible:!1,formLabelWidth:"80px",title:"新增停權帳號"}},computed:{days:function(){return this.formData.days},numberOfAccounts:function(){return this.formData.accounts.length},multiAccounts:function(){return this.formData.accounts[0].id+",..."},checked:function(){return this.formData.checked}},watch:{days:function(t){""===t||void 0===t?this.formData.recoverytime="":""!==t&&(this.formData.recoverytime=F()().add(t,"day").endOf("day").format("yyyy-MM-DD HH:mm:ss"))},checked:function(t){!0===t&&(this.formData.recoverytime="",this.formData.days="")}},methods:{handleClose:function(t){this.loading=!1,this.dialogFormVisible=!1,this.formData={recoverytime:"",accounts:[{id:""}],checked:!1}},handleOpen:function(t,e){this.dialogFormVisible=!0},createSuspension:function(){var t=this,e=new FormData;if(1===this.formData.accounts.length)e.append("suspendid",this.formData.accounts[0].id);else{var a=this.formData.accounts.map((function(t,e,a){return t.id}));e.append("suspendid",a.join())}e.append("recoverytime",this.formData.recoverytime),e.append("suspendstate",1),e.append("reason",this.formData.reason),d(e).then((function(e){var a=e.data;a.success?(t.$emit("initdata"),t.$message.success(a.msg)):t.$message.warning(a.msg),t.handleClose()})).catch((function(t){console.log(t)}))},removeAccount:function(t){var e=this.formData.accounts.indexOf(t);-1!==e&&this.formData.accounts.splice(e,1)},addAccount:function(){this.formData.accounts.push({id:"",key:Date.now()})},addAccounts:function(){this.$refs.addAccounts.handleOpen(),this.$refs.addAccounts.createInit()},setInit:function(t){this.formData=t}}},S=j,L=(a("5654"),Object(h["a"])(S,g,D,!1,null,"10783dfa",null)),V=L.exports,N={name:"AccountSuspension",components:{Dialog:V,List:v},data:function(){return{loading:!1,tabMapOptions:[{label:"停權名單",key:"all"}],activeName:"all",tableData:[]}},computed:{},mounted:function(){this.initdata()},created:function(){this.tableData=this.initData},methods:{checkPermission:r["a"],add:function(){this.$refs.dialog.handleOpen()},initdata:function(){var t=this;this.loading=!0,u().then((function(e){var a=e.data;a.success?t.tableData=Object(i["a"])(a.content):(t.tableData=[],t.$message.warning(a.msg)),t.loading=!1})).catch((function(t){console.log(t)}))}}},z=N,W=Object(h["a"])(z,n,o,!1,null,null,null);e["default"]=W.exports}}]);