(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-565c77a8"],{"457b":function(t,e,a){"use strict";a("826d")},"48fb":function(t,e,a){"use strict";a.d(e,"e",(function(){return n})),a.d(e,"f",(function(){return i})),a.d(e,"a",(function(){return s})),a.d(e,"d",(function(){return o})),a.d(e,"b",(function(){return l})),a.d(e,"c",(function(){return c}));var r=a("b775");function n(t){return Object(r["a"])({url:"/statistics_getremain",method:"post",data:t})}function i(t){return Object(r["a"])({url:"/statistics_getrevenue",method:"post",data:t})}function s(t){return Object(r["a"])({url:"/analysis/getuserdau",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/analysis/getuserwau",method:"post",data:t})}function l(t){return Object(r["a"])({url:"/analysis/getusermau",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/analysis/getusernru",method:"post",data:t})}},"4de6":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"page-container"},[a("search-panel",{ref:"searchPanel",on:{updatedTableData:t.updatedTableData}}),a("div",{staticClass:"table-container"},[a("el-tag",[t._v("活躍帳戶")])],1),a("chart",{staticClass:"account-chart"})],1)},n=[],i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search-panel"},[a("el-tag",[t._v("請輸入查詢條件")]),a("div",{staticStyle:{padding:"5px 0"}}),a("el-form",{ref:"form",attrs:{inline:!0,model:t.searchform,rules:t.rules}},["DAU"===t.date?[a("el-form-item",{attrs:{prop:"startDate"}},[a("el-date-picker",{attrs:{"value-format":"timestamp",type:"date",placeholder:"選擇開始日期"},model:{value:t.searchform.startDate,callback:function(e){t.$set(t.searchform,"startDate",e)},expression:"searchform.startDate"}})],1),a("el-form-item",{attrs:{prop:"endDate"}},[a("el-date-picker",{attrs:{"value-format":"timestamp",type:"date",placeholder:"選擇結束日期","picker-options":t.pickerOptions},model:{value:t.searchform.endDate,callback:function(e){t.$set(t.searchform,"endDate",e)},expression:"searchform.endDate"}})],1)]:[a("el-form-item",{attrs:{prop:"startDate"}},[a("el-date-picker",{attrs:{"value-format":"timestamp",type:"year",placeholder:"選擇年"},model:{value:t.searchform.startDate,callback:function(e){t.$set(t.searchform,"startDate",e)},expression:"searchform.startDate"}})],1)],a("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("查詢")])],2)],1)},s=[],o=a("c1df"),l=a.n(o),c={name:"SearchPanel",data:function(){return{loading:!1,isStartDateError:!1,searchform:{startDate:this.getMonthStart(),endDate:this.getMonthEnd(),type:"ALL"},rules:{startDate:[{required:!0,trigger:"change",validator:this.handleStartDate}],endDate:[{required:!0,trigger:"change",validator:this.handleEndDate}]},typeOptions:[{value:"all",label:"ALL"},{value:"android",label:"Android"},{value:"ios",label:"iOS"}],date:"DAU"}},computed:{pickerOptions:function(){var t=this;return{disabledDate:function(e){return!t.isStartDateError&&l()(e)<l()(t.searchform.startDate)}}}},mounted:function(){this.handleSearch()},methods:{handleSearch:function(){var t=this;this.loading=!0,this.$refs["form"].validate((function(e,a){if(!e)return console.log("error submit!!"),!1;var r=new FormData;r.append("startDate",l()(t.searchform.startDate).valueOf()),"dau"===t.date?r.append("endDate",l()(t.searchform.endDate).valueOf()):r.append("endDate",l()(t.searchform.startDate).endOf("year").valueOf()),t.$emit("updatedTableData",r,t.loading)}))},handleStartDate:function(t,e,a){e&&l()(e)>l()(this.searchform.endDate)?(this.isStartDateError=!0,a(new Error("請選擇正確的開始日期"))):e?(this.isStartDateError=!1,a()):a(new Error("開始日期不得為空"))},handleEndDate:function(t,e,a){if(e&&l()(e)<l()(this.searchform.startDate))return a(new Error("請選擇正確的結束日期"));e?(this.searchform.startDate&&this.$refs["form"].validateField(["startDate"]),this.isStartDateError=!1,a()):a(new Error("結束日期不得為空"))},getMonthStart:function(){return l()().startOf("month").valueOf()},getMonthEnd:function(){return l()().endOf("month").valueOf()},changeType:function(t){this.date=t,this.searchform.startDate=l()(this.searchform.startDate).startOf("year").valueOf()}}},d=c,u=a("2877"),h=Object(u["a"])(d,i,s,!1,null,null,null),f=h.exports,p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}},t._l(t.dateOptions,(function(t){return a("el-tab-pane",{key:t.value,attrs:{label:t.label,name:t.value}})})),1),t.$parent.loading?t._e():a("line-marker",{attrs:{type:t.date}}),a("tableData",{attrs:{date:t.date}})],1)},m=[],b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:{height:t.height,width:t.width}})},D=[],g=(a("4160"),a("159b"),a("313e")),v=a.n(g),y=a("ed08"),k={data:function(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted:function(){this.initListener()},activated:function(){this.$_resizeHandler||this.initListener(),this.resize()},beforeDestroy:function(){this.destroyListener()},deactivated:function(){this.destroyListener()},methods:{$_sidebarResizeHandler:function(t){"width"===t.propertyName&&this.$_resizeHandler()},initListener:function(){var t=this;this.$_resizeHandler=Object(y["b"])((function(){t.resize()}),100),window.addEventListener("resize",this.$_resizeHandler),this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},destroyListener:function(){window.removeEventListener("resize",this.$_resizeHandler),this.$_resizeHandler=null,this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)},resize:function(){var t=this.chart;t&&t.resize()}}};a("817d");var _={mixins:[k],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"250px"},autoResize:{type:Boolean,default:!0},type:{type:String,default:""}},inject:["group"],data:function(){return{chart:null,dateList:[],yAxisList:[]}},watch:{"group.tableData":{deep:!0,handler:function(t){t&&this.setOptions(this.group.tableData)}}},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},mounted:function(){var t=this;this.$nextTick((function(){t.initChart()}))},methods:{initChart:function(){this.chart=v.a.init(this.$el,"macarons"),this.setOptions(this.group.tableData)},setOptions:function(t){var e=this;this.dateList=[],this.yAxisList=[];var a=Object(y["c"])(t);a.sort((function(t,e){return t[0]-e[0]})),a.forEach((function(t){e.dateList.push(l()(t[0]).format("YYYY-MM-DD")),e.yAxisList.push(t[1])})),this.chart.setOption({title:{text:a.length?"":"無資料"},xAxis:{data:this.dateList,boundaryGap:!1,axisTick:{show:!1}},grid:{left:40,right:40,bottom:20,top:30,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},yAxis:{axisTick:{show:!1}},legend:{data:["DAU","WAU","MAU"]},series:[{name:"".concat(this.group.date),type:"line",symbolSize:5,symbol:"circle",smooth:0,itemStyle:{normal:{color:"#3888fa",lineStyle:{color:"#3888fa",width:2},areaStyle:{color:"#f3f8ff"}}},data:this.yAxisList,animationDuration:2800,animationEasing:"quadraticOut"}]})}}},O=_,E=Object(u["a"])(O,b,D,!1,null,null,null),S=E.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{attrs:{border:"","header-cell-style":t.headerStyle,data:t.group.tableData}},[a("el-table-column",{attrs:{label:"日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("moment")(e.row[0],"YYYY-MM-DD"))+" ")]}}])}),a("el-table-column",{attrs:{label:t.group.date},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row[1])+" ")]}}])})],1)],1)},w=[],x={name:"TableData",inject:["group"],props:{date:{type:String,default:""}},data:function(){return{headerStyle:{backgroundColor:"#f5f7fa"}}},methods:{handleData:function(){return"dau"===this.date?this.group.tableData.dau:"wau"===this.date?this.group.tableData.wau:this.group.tableData.mau}}},A=x,L=Object(u["a"])(A,$,w,!1,null,null,null),j=L.exports,U={name:"Chart",inject:["group"],components:{LineMarker:S,tableData:j},data:function(){return{date:"DAU",dateOptions:[{value:"DAU",label:"DAU"},{value:"WAU",label:"WAU"},{value:"MAU",label:"MAU"},{value:"NRU",label:"NRU"}]}},methods:{handleClick:function(){this.$parent.changeType(this.date)}}},z=U,M=(a("f754"),Object(u["a"])(z,p,m,!1,null,"ef1fddde",null)),T=M.exports,C=a("48fb"),H={name:"Index",components:{searchPanel:f,chart:T},data:function(){return{loading:!1,tableData:[],date:"DAU"}},provide:function(){return{group:this}},methods:{updatedTableData:function(t,e){switch(this.loading=!0,this.date){case"DAU":Object(C["a"])(t).then(this.callbackSuccess).catch(this.callbackError);break;case"WAU":Object(C["d"])(t).then(this.callbackSuccess).catch(this.callbackError);break;case"MAU":Object(C["b"])(t).then(this.callbackSuccess).catch(this.callbackError);break;case"NRU":Object(C["c"])(t).then(this.callbackSuccess).catch(this.callbackError);break}},callbackSuccess:function(t){var e=t.data;e.success?(this.tableData=e.content,this.tableData.sort((function(t,e){return e[0]-t[0]}))):(this.tableData=[],this.$message.warning(e.msg)),this.loading=!1},callbackError:function(t){console.log(t),this.loading=!1},changeType:function(t){this.date=t,this.$refs.searchPanel.changeType(t),this.$refs.searchPanel.handleSearch()}}},Y=H,N=(a("457b"),Object(u["a"])(Y,r,n,!1,null,"3e445892",null));e["default"]=N.exports},"826d":function(t,e,a){},be96:function(t,e,a){},f754:function(t,e,a){"use strict";a("be96")}}]);